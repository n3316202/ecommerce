{% extends 'layout/base.html' %}
{% load static %}

{% block content %}

    <!-- Head -->  
    {% include 'store/head.html' %}
    <div class="d-flex flex-column vh-100 justify-content-between">
    <!-- 네비게이션바 -->
    {% include "layout/navbar.html" %}    
    {% comment %} <!-- Header -->  
    {% include 'store/header.html' %} {% endcomment %}

    <div class="container">
      <div class="card mb-3">
        <div class="row g-0">
          <div class="col-md-4">
            {% comment %} dev_40 {% endcomment %}
            <img src="{{product.image.url}}" style="width: 100%;height:18.6rem;object-fit:fill;" class="img-fluid rounded-start" alt="..." />
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <center>
                <h5 class="card-title">{{product.name}}</h5>
                <p class="card-text">{{product.description}}</p>
    
                {% if product.is_sale%}
    
                <div class="d-flex justify-content-center small text-warning mb-2">
                  <div class="bi-star-fill"></div>
                  <div class="bi-star-fill"></div>
                  <div class="bi-star-fill"></div>
                  <div class="bi-star-fill"></div>
                  <div class="bi-star-fill"></div>
                </div>
                <!-- Product price-->
                <strike> ${{ product.price }} </strike>
                &nbsp; ${{product.sale_price}} 
                {% else %} 
                  ${{ product.price }} 
                {%endif%}
                <br/><br>
                <!-- 수량 추가-->
                <div class="row justify-content-center">
                  <div class="col-md-2">갯수:</div>
                  <div class="col-md-2">
                    <select class="form-select form-select-sm" id="qty-cart" aria-label="Default select example">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                </div>
                <!-- 수량 추가끝-->
                <br><br><a class="btn btn-secondary" href="{% url 'store:home' %}">홈으로</a>
                <button type="button" value="{{product.id}}" id="add-cart" class="btn btn-secondary">장바구니 담기</button>
              </center>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer-->
    {% include 'store/footer.html' %}
  </div>

  <script>
    $(document).on('click', '#add-cart',function(e){
      $.ajax({
        type:"POST",
        url:"{% url 'cart:cart_add' %}",
        data:{
          product_id: $('#add-cart').val(),
          product_qty: $('#qty-cart option:selected').text(),
          csrfmiddlewaretoken:'{{  csrf_token }}',
          action: 'post'
        },
        success : function(json){
          console.log(json)
          //$('#cart_quantity').text(json.qty)
          //추가 dev_38
          //location.reload();
          //dev_40
          location.href = "{% url 'cart:cart_summary' %}"
        },
        error : function(e){
          console.log(e)
        }
      })
    });
  </script>
  {% endblock content %}


